this.Handlebars=this.Handlebars||{},this.Handlebars.templates=this.Handlebars.templates||{},this.Handlebars.templates.CoursesContainer=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n            <li><a href='/#/students'>Students</a> <span class='divider'>/</span></li>\n            <li><a href='/#/students/",(d=c.studentId)?d=d.call(a,{hash:{},data:b}):(d=a.studentId,d=typeof d===m?d.apply(a):d),e+=n(d)+"'>"+n((d=a.student,d=null==d||d===!1?d:d.name,typeof d===m?d.apply(a):d))+"</a> <span class='divider'>/</span></li>\n        "}function g(a,b){var d,e,f="";return f+="\n\n                ",e={hash:{},inverse:o.noop,fn:o.programWithDepth(4,h,b,a),data:b},(d=c.courses)?d=d.call(a,e):(d=a.courses,d=typeof d===m?d.apply(a):d),c.courses||(d=p.call(a,d,e)),(d||0===d)&&(f+=d),f+="\n\n            "}function h(a,b,d){var e,f,g="";return g+="\n                    <tr>\n                        <td class='link'><a href='#/students/"+n((e=d.studentId,typeof e===m?e.apply(a):e))+"/courses/",(f=c.id)?f=f.call(a,{hash:{},data:b}):(f=a.id,f=typeof f===m?f.apply(a):f),g+=n(f)+"/exercises'>",(f=c.name)?f=f.call(a,{hash:{},data:b}):(f=a.name,f=typeof f===m?f.apply(a):f),g+=n(f)+"</a></td>\n                    </tr>\n                "}function i(a,b){var d,e,f="";return f+="\n\n                ",e={hash:{},inverse:o.noop,fn:o.program(7,j,b),data:b},(d=c.courses)?d=d.call(a,e):(d=a.courses,d=typeof d===m?d.apply(a):d),c.courses||(d=p.call(a,d,e)),(d||0===d)&&(f+=d),f+="\n\n            "}function j(a,b){var d,e="";return e+="\n                    <tr>\n                        <td class='link'><a href='#/courses/",(d=c.id)?d=d.call(a,{hash:{},data:b}):(d=a.id,d=typeof d===m?d.apply(a):d),e+=n(d)+"/exercises'>",(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a.name,d=typeof d===m?d.apply(a):d),e+=n(d)+"</a></td>\n                    </tr>\n                "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l="",m="function",n=this.escapeExpression,o=this,p=c.blockHelperMissing;return l+="<section>\n\n    <ul class='breadcrumb'>\n\n        <li><a href='/'>Home</a> <span class='divider'>/</span></li>\n\n        ",k=c["if"].call(b,b.studentId,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(k||0===k)&&(l+=k),l+="\n\n        <li class='active'>Courses</li>\n\n    </ul>\n\n    <h2>Courses</h2>\n\n    <table class='table table-hover'>\n\n        <thead>\n            <tr>\n                <th>Name</th>\n            </tr>\n        </thead>\n\n        <tbody>\n\n            ",k=c["if"].call(b,b.studentId,{hash:{},inverse:o.program(6,i,e),fn:o.program(3,g,e),data:e}),(k||0===k)&&(l+=k),l+="\n\n        </tbody>\n\n    </table>\n\n</section>\n"}),this.Handlebars.templates.EditorSettingsContainer=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"<footer>\n\n    <a href='#editor-settings' data-toggle='modal' class='pull-right'><i class='icon-wrench icon-gray'></i></a>\n\n    <div id='editor-settings' class='modal hide fade' tabindex='-1' data-backdrop='false'>\n\n        <div class='modal-header'>\n\n            <header>\n\n                <button type='button' class='close' data-dismiss='modal'>×</button>\n\n                <h1>Settings</h1>\n\n            </header>\n\n        </div>\n\n        <div class='modal-body'>\n\n            <form class='form-horizontal'>\n\n                <fieldset>\n\n                    <div class='control-group'>\n\n                        <label class='checkbox'>\n                            <input type='checkbox' data-id='ignore-empty-lines'> Ignore empty lines (improves diff results)\n                        </label>\n\n                    </div>\n\n                    <div class='control-group'>\n\n                        <label class='control-label' for='theme'>Theme</label>\n\n                        <div class='controls'>\n\n                            <select data-id='theme'>\n                                <option value='ace/theme/light'>Light</option>\n                                <option value='ace/theme/dark'>Dark</option>\n                            </select>\n\n                        </div>\n\n                    </div>\n\n                    <div class='control-group'>\n\n                        <label class='control-label' for='font-size'>Font size</label>\n\n                        <div class='controls'>\n\n                            <select data-id='font-size'>\n                                <option value='11'>Small</option>\n                                <option value='12' selected>Normal</option>\n                                <option value='13'>Larger</option>\n                                <option value='14'>Large</option>\n                                <option value='15'>Extra Large</option>\n                            </select>\n\n                        </div>\n\n                </fieldset>\n\n            </form>\n\n        </div>\n\n        <div class='modal-footer'>\n\n            <button class='btn' data-dismiss='modal'>Cancel</button>\n            <button data-id='save' class='btn btn-primary' data-dismiss='modal'>Save</button>\n\n        </div>\n\n</footer>\n"}),this.Handlebars.templates.EditorTopContainer=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+="<header>\n\n    <h1>",(f=c.name)?f=f.call(b,{hash:{},data:e}):(f=b.name,f=typeof f===j?f.apply(b):f),i+=k(f)+"</h1>\n\n    <span class='pull-right'>\n\n        + ",h={hash:{},data:e},i+=k((f=c.duration||b.duration,f?f.call(b,(f=b.snapshot,null==f||f===!1?f:f.snapshotTime),(f=b.previous,f=null==f||f===!1?f:f.snapshot,null==f||f===!1?f:f.snapshotTime),h):l.call(b,"duration",(f=b.snapshot,null==f||f===!1?f:f.snapshotTime),(f=b.previous,f=null==f||f===!1?f:f.snapshot,null==f||f===!1?f:f.snapshotTime),h)))+"\n\n        <a id='editor-inspector' href='#' data-toggle='popover' data-placement='bottom'\n\n           data-original-title='\n\n                <time>",h={hash:{},data:e},i+=k((f=c.date||b.date,f?f.call(b,(f=b.previous,f=null==f||f===!1?f:f.snapshot,null==f||f===!1?f:f.snapshotTime),h):l.call(b,"date",(f=b.previous,f=null==f||f===!1?f:f.snapshot,null==f||f===!1?f:f.snapshotTime),h)))+" –</time>\n                <time>",h={hash:{},data:e},i+=k((f=c.date||b.date,f?f.call(b,(f=b.snapshot,null==f||f===!1?f:f.snapshotTime),h):l.call(b,"date",(f=b.snapshot,null==f||f===!1?f:f.snapshotTime),h)))+"</time>\n\n           '\n\n           data-content='\n\n            <dl class=\"dl-horizontal pull-left\">\n\n              <dt>Change</dt>\n              <dd>",(g=c.percentageOfChange)?g=g.call(b,{hash:{},data:e}):(g=b.percentageOfChange,g=typeof g===j?g.apply(b):g),i+=k(g)+" %</dd>\n\n              <dt>Insert</dt>\n              <dd>"+k((f=b.difference,f=null==f||f===!1?f:f.insert,typeof f===j?f.apply(b):f))+" ",h={hash:{},data:e},i+=k((f=c.pluralize||b.pluralize,f?f.call(b,(f=b.difference,null==f||f===!1?f:f.insert),"line",h):l.call(b,"pluralize",(f=b.difference,null==f||f===!1?f:f.insert),"line",h)))+"</dd>\n\n              <dt>Replace</dt>\n              <dd>"+k((f=b.difference,f=null==f||f===!1?f:f.replace,typeof f===j?f.apply(b):f))+" ",h={hash:{},data:e},i+=k((f=c.pluralize||b.pluralize,f?f.call(b,(f=b.difference,null==f||f===!1?f:f.replace),"line",h):l.call(b,"pluralize",(f=b.difference,null==f||f===!1?f:f.replace),"line",h)))+"</dd>\n\n              <dt>Delete</dt>\n              <dd>"+k((f=b.difference,f=null==f||f===!1?f:f["delete"],typeof f===j?f.apply(b):f))+" ",h={hash:{},data:e},i+=k((f=c.pluralize||b.pluralize,f?f.call(b,(f=b.difference,null==f||f===!1?f:f["delete"]),"line",h):l.call(b,"pluralize",(f=b.difference,null==f||f===!1?f:f["delete"]),"line",h)))+"</dd>\n\n            </dl>\n\n        '><i class='icon-info-sign icon-gray'></i></a>\n\n    </span>\n\n</header>\n"}),this.Handlebars.templates.Error=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+="<p class='alert ",(f=c["class"])?f=f.call(b,{hash:{},data:e}):(f=b["class"],f=typeof f===h?f.apply(b):f),g+=i(f)+"'>",(f=c.message)?f=f.call(b,{hash:{},data:e}):(f=b.message,f=typeof f===h?f.apply(b):f),g+=i(f)+"</p>\n"}),this.Handlebars.templates.ExercisesContainer=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n            <li><a href='/#/students'>Students</a> <span class='divider'>/</span></li>\n            <li><a href='/#/students/",(d=c.studentId)?d=d.call(a,{hash:{},data:b}):(d=a.studentId,d=typeof d===o?d.apply(a):d),e+=p(d)+"'>"+p((d=a.student,d=null==d||d===!1?d:d.name,typeof d===o?d.apply(a):d))+"</a> <span class='divider'>/</span></li>\n        "}function g(a,b){var d,e="";return e+="students/",(d=c.studentId)?d=d.call(a,{hash:{},data:b}):(d=a.studentId,d=typeof d===o?d.apply(a):d),e+=p(d)+"/"}function h(a,b){var d,e,f="";return f+="\n\n                ",e={hash:{},inverse:q.noop,fn:q.programWithDepth(6,i,b,a),data:b},(d=c.exercises)?d=d.call(a,e):(d=a.exercises,d=typeof d===o?d.apply(a):d),c.exercises||(d=r.call(a,d,e)),(d||0===d)&&(f+=d),f+="\n\n            "}function i(a,b,d){var e,f,g="";return g+="\n                    <tr>\n                        <td class='link'><a href='#/students/"+p((e=d.studentId,typeof e===o?e.apply(a):e))+"/courses/"+p((e=d.courseId,typeof e===o?e.apply(a):e))+"/exercises/",(f=c.id)?f=f.call(a,{hash:{},data:b}):(f=a.id,f=typeof f===o?f.apply(a):f),g+=p(f)+"/snapshots'>",(f=c.name)?f=f.call(a,{hash:{},data:b}):(f=a.name,f=typeof f===o?f.apply(a):f),g+=p(f)+"</a></td>\n                    </tr>\n                "}function j(a,b){var d,e,f="";return f+="\n\n                ",e={hash:{},inverse:q.noop,fn:q.programWithDepth(9,k,b,a),data:b},(d=c.exercises)?d=d.call(a,e):(d=a.exercises,d=typeof d===o?d.apply(a):d),c.exercises||(d=r.call(a,d,e)),(d||0===d)&&(f+=d),f+="\n\n            "}function k(a,b,d){var e,f,g="";return g+="\n                    <tr>\n                        <td class='link'><a href='#/courses/"+p((e=d.courseId,typeof e===o?e.apply(a):e))+"/exercises/",(f=c.id)?f=f.call(a,{hash:{},data:b}):(f=a.id,f=typeof f===o?f.apply(a):f),g+=p(f)+"/students'>",(f=c.name)?f=f.call(a,{hash:{},data:b}):(f=a.name,f=typeof f===o?f.apply(a):f),g+=p(f)+"</a></td>\n                    </tr>\n                "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n="",o="function",p=this.escapeExpression,q=this,r=c.blockHelperMissing;return n+="<section>\n\n    <ul class='breadcrumb'>\n\n        <li><a href='/'>Home</a> <span class='divider'>/</span></li>\n\n        ",l=c["if"].call(b,b.studentId,{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(l||0===l)&&(n+=l),n+="\n\n        <li><a href='/#/",l=c["if"].call(b,b.studentId,{hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e}),(l||0===l)&&(n+=l),n+="courses'>Courses</a> <span class='divider'>/</span></li>\n        <li><a href='/#/",l=c["if"].call(b,b.studentId,{hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e}),(l||0===l)&&(n+=l),n+="courses/",(l=c.courseId)?l=l.call(b,{hash:{},data:e}):(l=b.courseId,l=typeof l===o?l.apply(b):l),n+=p(l)+"'>"+p((l=b.course,l=null==l||l===!1?l:l.name,typeof l===o?l.apply(b):l))+"</a> <span class='divider'>/</span></li>\n        <li class='active'>Exercises</li>\n\n    </ul>\n\n    <h2>Exercises</h2>\n\n    <table class='table table-hover'>\n\n        <thead>\n            <tr>\n                <th>Name</th>\n            </tr>\n        </thead>\n\n        <tbody>\n\n            ",m=c["if"].call(b,b.studentId,{hash:{},inverse:q.program(8,j,e),fn:q.program(5,h,e),data:e}),(m||0===m)&&(n+=m),n+="\n\n        </tbody>\n\n    </table>\n\n</section>\n"}),this.Handlebars.templates.RootContainer=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"<section>\n\n    <ul class='breadcrumb'>\n        <li class='active'>Home</li>\n    </ul>\n\n    <ul class='nav nav-tabs nav-stacked selection'>\n        <li><a href='/#/students'>Students</a></li>\n        <li><a href='/#/courses'>Courses</a></li>\n    </ul>\n\n</section>\n"}),this.Handlebars.templates.SnapshotFilesContainer=Handlebars.template(function(a,b,c,d,e){function f(a,b,d){var e,f,g="";return g+="\n        <li data-id='",(e=c.id)?e=e.call(a,{hash:{},data:b}):(e=a.id,e=typeof e===k?e.apply(a):e),g+=l(e)+"'><a href='#/students/"+l((e=d.studentId,typeof e===k?e.apply(a):e))+"/courses/"+l((e=d.courseId,typeof e===k?e.apply(a):e))+"/exercises/"+l((e=d.exerciseId,typeof e===k?e.apply(a):e))+"/snapshots/"+l((e=d.id,typeof e===k?e.apply(a):e))+"/files/",(f=c.id)?f=f.call(a,{hash:{},data:b}):(f=a.id,f=typeof f===k?f.apply(a):f),g+=l(f)+"'><i class='icon-file icon-gray'></i> ",(f=c.name)?f=f.call(a,{hash:{},data:b}):(f=a.name,f=typeof f===k?f.apply(a):f),g+=l(f)+"</a></li>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=this,n=c.blockHelperMissing;return j+="<header>\n\n    <i class='icon-folder-close icon-gray'></i> <h1>"+l((g=b.exercise,g=null==g||g===!1?g:g.name,typeof g===k?g.apply(b):g))+"</h1>\n\n</header>\n\n<ul>\n    ",i={hash:{},inverse:m.noop,fn:m.programWithDepth(1,f,e,b),data:e},(h=c.files)?h=h.call(b,i):(h=b.files,h=typeof h===k?h.apply(b):h),c.files||(h=n.call(b,h,i)),(h||0===h)&&(j+=h),j+="\n</ul>\n"}),this.Handlebars.templates.SnapshotNavigationContainer=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+="<div class='row'>\n\n    <div class='span2'>\n\n        <button id='toggleFiles' type='button' class='btn' data-toggle='button'><i class='icon-folder icon-gray'></i></button>\n        <button id='split' type='button' class='btn' data-toggle='button'><i class='icon-split-editor icon-gray'></i></button>\n        <button id='diff' type='button' class='btn' data-toggle='button'><i class='icon-diff icon-gray'></i></button>\n\n    </div>\n\n    <div class='span4 pull-right'>\n\n        <div class='row'>\n\n            <div class='span1 text-center'>",(f=c.current)?f=f.call(b,{hash:{},data:e}):(f=b.current,f=typeof f===h?f.apply(b):f),g+=i(f)+" / ",(f=c.total)?f=f.call(b,{hash:{},data:e}):(f=b.total,f=typeof f===h?f.apply(b):f),g+=i(f)+"</div>\n\n            <div class='span3'>\n\n                <div class='btn-group pull-right'>\n                    <button type='button' id='first' class='btn'>First</button>\n                    <button type='button' id='previous' class='btn'>Previous</button>\n                    <button type='button' id='next' class='btn'>Next</button>\n                    <button type='button' id='last' class='btn'>Last</button>\n                </div>\n\n            </div>\n\n        </div>\n\n    </div>\n\n</div>\n"}),this.Handlebars.templates.SnapshotsTimelineBottomContainer=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+="<div class='row'>\n\n    <div class='span2'>\n\n        <time>",g={hash:{},data:e},h+=j((f=c.date||b.date,f?f.call(b,(f=b.first,null==f||f===!1?f:f.snapshotTime),!1,g):i.call(b,"date",(f=b.first,null==f||f===!1?f:f.snapshotTime),!1,g)))+"</time>\n\n    </div>\n\n    <div class='center text-center'>. . .</div>\n\n    <div class='span3 pull-right'>\n\n        <time class='pull-right'>",g={hash:{},data:e},h+=j((f=c.date||b.date,f?f.call(b,(f=b.last,null==f||f===!1?f:f.snapshotTime),!1,g):i.call(b,"date",(f=b.last,null==f||f===!1?f:f.snapshotTime),!1,g)))+" (+ ",g={hash:{},data:e},h+=j((f=c.duration||b.duration,f?f.call(b,(f=b.last,null==f||f===!1?f:f.snapshotTime),(f=b.first,null==f||f===!1?f:f.snapshotTime),g):i.call(b,"duration",(f=b.last,null==f||f===!1?f:f.snapshotTime),(f=b.first,null==f||f===!1?f:f.snapshotTime),g)))+")</time>\n\n    </div>\n\n</div>\n"}),this.Handlebars.templates.StudentsContainer=Handlebars.template(function(a,b,c,d,e){function f(a){var b,c="";return c+="\n            <li><a href='/#/courses'>Courses</a> <span class='divider'>/</span></li>\n            <li><a href='/#/courses/"+n((b=a.course,b=null==b||b===!1?b:b.id,typeof b===m?b.apply(a):b))+"'>"+n((b=a.course,b=null==b||b===!1?b:b.name,typeof b===m?b.apply(a):b))+"</a> <span class='divider'>/</span></li>\n            <li><a href='/#/courses/"+n((b=a.course,b=null==b||b===!1?b:b.id,typeof b===m?b.apply(a):b))+"/exercises'>Exercises</a> <span class='divider'>/</span></li>\n            <li><a href='/#/courses/"+n((b=a.course,b=null==b||b===!1?b:b.id,typeof b===m?b.apply(a):b))+"/exercises/"+n((b=a.exercise,b=null==b||b===!1?b:b.id,typeof b===m?b.apply(a):b))+"'>"+n((b=a.exercise,b=null==b||b===!1?b:b.name,typeof b===m?b.apply(a):b))+"</a> <span class='divider'>/</span></li>\n        "}function g(a,b){var d,e,f="";return f+="\n\n                ",e={hash:{},inverse:o.noop,fn:o.programWithDepth(4,h,b,a),data:b},(d=c.students)?d=d.call(a,e):(d=a.students,d=typeof d===m?d.apply(a):d),c.students||(d=p.call(a,d,e)),(d||0===d)&&(f+=d),f+="\n\n            "}function h(a,b,d){var e,f,g="";return g+="\n                    <tr>\n                        <td class='link'><a href='#/courses/"+n((e=d.course,e=null==e||e===!1?e:e.id,typeof e===m?e.apply(a):e))+"/exercises/"+n((e=d.exercise,e=null==e||e===!1?e:e.id,typeof e===m?e.apply(a):e))+"/students/",(f=c.id)?f=f.call(a,{hash:{},data:b}):(f=a.id,f=typeof f===m?f.apply(a):f),g+=n(f)+"/snapshots'>",(f=c.name)?f=f.call(a,{hash:{},data:b}):(f=a.name,f=typeof f===m?f.apply(a):f),g+=n(f)+"</a></td>\n                    </tr>\n                "}function i(a,b){var d,e,f="";return f+="\n\n                ",e={hash:{},inverse:o.noop,fn:o.program(7,j,b),data:b},(d=c.students)?d=d.call(a,e):(d=a.students,d=typeof d===m?d.apply(a):d),c.students||(d=p.call(a,d,e)),(d||0===d)&&(f+=d),f+="\n\n            "}function j(a,b){var d,e="";return e+="\n                    <tr>\n                        <td class='link'><a href='#/students/",(d=c.id)?d=d.call(a,{hash:{},data:b}):(d=a.id,d=typeof d===m?d.apply(a):d),e+=n(d)+"/courses'>",(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a.name,d=typeof d===m?d.apply(a):d),e+=n(d)+"</a></td>\n                    </tr>\n                "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l="",m="function",n=this.escapeExpression,o=this,p=c.blockHelperMissing;return l+="<section>\n\n    <ul class='breadcrumb'>\n        <li><a href='/'>Home</a> <span class='divider'>/</span></li>\n\n        ",k=c["if"].call(b,b.course,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(k||0===k)&&(l+=k),l+="\n\n        <li class='active'>Students</li>\n    </ul>\n\n    <h2>Students</h2>\n\n    <table class='table table-hover'>\n\n        <thead>\n            <tr>\n                <th>Name</th>\n            </tr>\n        </thead>\n\n        <tbody>\n\n            ",k=c["if"].call(b,b.course,{hash:{},inverse:o.program(6,i,e),fn:o.program(3,g,e),data:e}),(k||0===k)&&(l+=k),l+="\n\n        </tbody>\n\n    </table>\n\n</section>\n"});var config={storage:{setting:{editor:{ignoreEmptyLines:"codebrowser.setting.editor.ignoreEmptyLines",theme:"codebrowser.setting.editor.theme",fontSize:"codebrowser.setting.editor.fontSize"}},view:{SnapshotView:{files:"codebrowser.view.SnapshotView.files"},EditorView:{split:"codebrowser.view.EditorView.split",diff:"codebrowser.view.EditorView.diff"}}},api:{main:{root:"http://t-avihavai.users.cs.helsinki.fi/cb-back/app/"}},cache:{expires:3600},view:{container:"#container"},editor:{configure:function(a){a.setReadOnly(!0),a.setPrintMarginColumn(!1),a.setDisplayIndentGuides(!1),a.getSession().setFoldStyle("markbeginend"),a.setTheme(localStorage.getItem(config.storage.setting.editor.theme)||"ace/theme/light"),a.setFontSize(parseInt(localStorage.getItem(config.storage.setting.editor.fontSize),10)||12),a.getSession().setTabSize(4),a.getSession().setUseWrapMode(!0),a.getSession().setWrapLimitRange(120,120)}}};$(document).ready(function(){codebrowser.initialize()});var codebrowser={app:{},helper:{},model:{},collection:{},view:{},controller:{},router:{},initialize:function(){window.onerror=function(){var a=new codebrowser.view.ErrorView({model:{"class":"alert-error",message:"Oops!"}});codebrowser.controller.ViewController.push(a,!0)},codebrowser.app.base=new codebrowser.router.BaseRouter,codebrowser.app.student=new codebrowser.router.StudentRouter,codebrowser.app.course=new codebrowser.router.CourseRouter,codebrowser.app.exercise=new codebrowser.router.ExerciseRouter,codebrowser.app.snapshot=new codebrowser.router.SnapshotRouter,Backbone.history.start()}};codebrowser.helper.AceMode={mode:{java:"java"},getModeForFilename:function(a){var b="text";if(-1!==a.indexOf(".")&&0!==a.indexOf(".")){var c=a.split("."),d=c[c.length-1];b=this.mode[d]||b}return"ace/mode/"+b}},Handlebars.registerHelper("date",function(a,b){return b?moment(new Date(a)).format("D.M.YYYY HH.mm.ss"):moment(new Date(a)).format("D.M.YYYY HH.mm")}),codebrowser.helper.Duration={calculate:function(a,b,c){var d,e,f=a-b,g=Math.round(f/1e3);if(g>60){var h=Math.round(g/60);if(h>60){var i=Math.round(h/60);if(i>24){var j=Math.round(i/24);d=j,e="day"}else d=i,e="hour"}else d=h,e="minute"}else d=g,e="second";return 1!==d&&(e+="s"),c&&(e=e.slice(0,1)),d+" "+e}},Handlebars.registerHelper("duration",function(a,b){return codebrowser.helper.Duration.calculate(a,b)}),Handlebars.registerHelper("pluralize",function(a,b){return 1===a?b:b+"s"}),codebrowser.model.Course=Backbone.RelationalModel.extend({urlRoot:config.api.main.root+"courses",relations:[{type:Backbone.HasMany,key:"exercises",relatedModel:"codebrowser.model.Exercise",collectionType:"codebrowser.collection.ExerciseCollection",reverseRelation:{key:"course"}}]}),codebrowser.model.Diff=function(a,b){for(var c={replace:0,insert:0,"delete":0,total:function(){return this.replace+this.insert+this["delete"]}},d={insert:[],replace:[],"delete":[],all:[]},e=difflib.stringAsLines(a),f=difflib.stringAsLines(b),g=new difflib.SequenceMatcher(e,f),h=g.get_opcodes(),i=0,j=0,k=0;k<h.length;k++){var l=h[k],m={type:l[0],rowStart:l[3],rowEnd:l[4]-1,offset:i,overwrite:!1};if(console.log("type: "+l[0]),console.log("fromRowStart: "+l[1]),console.log("fromRowEnd: "+(l[2]-1)),console.log(""),console.log("toRowStart: "+l[3]),console.log("toRowEnd: "+(l[4]-1)),console.log("--------"),"equal"!==m.type){if("replace"===m.type){var n=_.clone(m),o=l[2]-l[1]-1,p=l[4]-l[3]-1,q=m.rowEnd-m.rowStart+1,r=l[2]-l[1];if(o>p&&(d.replace.push(m),d.all.push(m),c.replace+=m.rowEnd-m.rowStart+1,m=n,m.type="delete",l[1]+=q),p>o){m.rowEnd=m.rowStart+r-1,d.replace.push(m),d.all.push(m),c.replace+=m.rowEnd-m.rowStart+1;var s=m.rowEnd+1;m=n,m.type="insert",m.rowStart=s}}if("insert"===m.type&&(j+=m.rowEnd-m.rowStart+1),"delete"===m.type){var t=e.slice(l[1],l[2]),u=t.join("\n");m.overwrite||(u+="\n"),m.rowStart=l[1]+j,m.rowEnd=l[2]-1+j,m=_.extend(m,{fromRowStart:l[1],fromRowEnd:l[2]-1,lines:u}),m.overwrite||((this.lastDifferenceType&&"delete"===this.lastDifferenceType||"replace"===this.lastDifferenceType&&this.increase)&&(m.offset-=this.increase,m.rowStart-=this.increase,m.rowEnd-=this.increase),this.increase=m.rowEnd-m.rowStart+1,i+=this.increase,j+=this.increase)}this.lastDifferenceType=m.type,c[m.type]+=m.rowEnd-m.rowStart+1,d[m.type].push(m),d.all.push(m)}}this.getCount=function(){return c},this.getDifferences=function(){return d}},codebrowser.model.Exercise=Backbone.RelationalModel.extend({urlRoot:function(){return this.get("course").url()+"/exercises"}}),codebrowser.model.File=Backbone.RelationalModel.extend({content:"",urlRoot:function(){return config.api.main.root+"students/"+this.get("snapshot").get("studentId")+"/courses/"+this.get("snapshot").get("courseId")+"/exercises/"+this.get("snapshot").get("exerciseId")+"/snapshots/"+this.get("snapshot").id+"/files"},getContent:function(){var a=localStorage.getItem(config.storage.setting.editor.ignoreEmptyLines),b=this.content;return b=b.replace(/\r\n|\r/g,"\n"),b=b.replace(/\t/g,"    "),a&&"true"===a&&(b=b.replace(/^ +$/gm,"")),b},lines:function(){return this.getContent().split("\n").length},fetchContent:function(a){if(0!==this.content.length)return a(this.getContent(),null),void 0;var b=this,c=$.get(this.urlRoot()+"/"+this.id+"/content",function(c){b.content=c,a(b.getContent(),null)});c.fail(function(){a(null,c)})}}),codebrowser.model.Snapshot=Backbone.RelationalModel.extend({urlRoot:function(){if(!this.get("studentId")||!this.get("courseId")||!this.get("exerciseId"))throw new Error("Attributes studentId, courseId and exerciseId are required to fetch a snapshot.");return config.api.main.root+"students/"+this.get("studentId")+"/courses/"+this.get("courseId")+"/exercises/"+this.get("exerciseId")+"/snapshots"},relations:[{type:Backbone.HasMany,key:"files",relatedModel:"codebrowser.model.File",collectionType:"codebrowser.collection.FileCollection",reverseRelation:{key:"snapshot"}},{type:Backbone.HasOne,key:"course",relatedModel:"codebrowser.model.Course"},{type:Backbone.HasOne,key:"exercise",relatedModel:"codebrowser.model.Exercise"}],initialize:function(){this.collection&&(this.set("studentId",this.collection.studentId),this.set("courseId",this.collection.courseId),this.set("exerciseId",this.collection.exerciseId))}}),codebrowser.model.Student=Backbone.RelationalModel.extend({urlRoot:config.api.main.root+"students",relations:[{type:Backbone.HasMany,key:"courses",relatedModel:"codebrowser.model.Course",collectionType:"codebrowser.collection.CourseCollection"}]}),codebrowser.collection.CourseCollection=Backbone.Collection.extend({model:codebrowser.model.Course,url:function(){return this.studentId?config.api.main.root+"students/"+this.studentId+"/courses":config.api.main.root+"courses"},initialize:function(a,b){b&&(this.studentId=b.studentId)}}),codebrowser.collection.ExerciseCollection=Backbone.Collection.extend({model:codebrowser.model.Exercise,url:function(){if(this.course)return this.course.url()+"/exercises";if(!this.studentId||!this.courseId)throw new Error("Options studentId and courseId are required to fetch exercises.");return config.api.main.root+"students/"+this.studentId+"/courses/"+this.courseId+"/exercises"},initialize:function(a,b){b&&(this.studentId=b.studentId,this.courseId=b.courseId)}}),codebrowser.collection.FileCollection=Backbone.Collection.extend({model:codebrowser.model.File,url:function(){return config.api.main.root+"students/"+this.snapshot.get("studentId")+"/courses/"+this.snapshot.get("courseId")+"/exercises/"+this.snapshot.get("exerciseId")+"/snapshots/"+this.snapshot.id+"/files"}}),codebrowser.collection.SnapshotCollection=Backbone.Collection.extend({model:codebrowser.model.Snapshot,differencesDone:!1,differences:[],url:function(){if(!this.studentId||!this.courseId||!this.exerciseId)throw new Error("Options studentId, courseId and exerciseId are required to fetch snapshots.");return config.api.main.root+"students/"+this.studentId+"/courses/"+this.courseId+"/exercises/"+this.exerciseId+"/snapshots"},initialize:function(a,b){b&&(this.studentId=b.studentId,this.courseId=b.courseId,this.exerciseId=b.exerciseId)},getDuration:function(a,b){return this.at(a).get("snapshotTime")-this.at(b).get("snapshotTime")},getMinDuration:function(){var a=this,b=Number.MAX_VALUE;return this.each(function(c,d){if(0!==d){var e=a.getDuration(d,d-1);b>e&&(b=e)}}),b},getMaxDuration:function(){var a=this,b=Number.MIN_VALUE;return this.each(function(c,d){if(0!==d){var e=a.getDuration(d,d-1);e>b&&(b=e)}}),b},getDifference:function(a,b){var c=this.differences[a];return c?c[b]:null},getDifferences:function(a){return this.differencesDone?(a(this.differences),void 0):void 0}}),codebrowser.collection.StudentCollection=Backbone.Collection.extend({model:codebrowser.model.Student,url:function(){return this.courseId&&this.exerciseId?config.api.main.root+"courses/"+this.courseId+"/exercises/"+this.exerciseId+"/students":config.api.main.root+"students"},initialize:function(a){a&&(this.courseId=a.courseId,this.exerciseId=a.exerciseId)}}),codebrowser.view.CoursesView=Backbone.View.extend({id:"courses-container",template:Handlebars.templates.CoursesContainer,render:function(){var a={studentId:this.collection.studentId,student:this.student.toJSON(),courses:this.collection.toJSON()},b=this.template(a);this.$el.html(b)}}),codebrowser.view.EditorSettingsView=Backbone.View.extend({id:"editor-settings-container",template:Handlebars.templates.EditorSettingsContainer,events:{'click [data-id="save"]':"save"},initialize:function(a){this.parentView=a.parentView,this.render()},render:function(){var a=localStorage.getItem(config.storage.setting.editor.ignoreEmptyLines),b=parseInt(localStorage.getItem(config.storage.setting.editor.fontSize),10),c=localStorage.getItem(config.storage.setting.editor.theme),d=$(this.template());a&&$('[data-id="ignore-empty-lines"]',d).prop("checked","true"===a),c&&$('[data-id="theme"] option[value="'+c+'"]',d).prop("selected",!0),b&&$('[data-id="font-size"] option[value="'+b+'"]',d).prop("selected",!0),this.$el.html(d)},save:function(){localStorage.setItem(config.storage.setting.editor.ignoreEmptyLines,$('[data-id="ignore-empty-lines"]').prop("checked")),localStorage.setItem(config.storage.setting.editor.theme,$('[data-id="theme"] option:selected',this.$el).val()),localStorage.setItem(config.storage.setting.editor.fontSize,$('[data-id="font-size"] option:selected',this.$el).val()),this.parentView.configure(),this.parentView.update(this.parentView.previousModel,this.parentView.model)}}),codebrowser.view.EditorView=Backbone.View.extend({id:"editor-container",template:{topContainer:Handlebars.templates.EditorTopContainer},decorations:{"main-editor":[],"side-editor":[]},markers:{"main-editor":[],"side-editor":[]},insertedLines:{"main-editor":[]},replacedLines:{"main-editor":[]},events:{"click #editor-inspector":"toggleInspector"},split:!1,canSplit:function(){return this.model!==this.previousModel},diff:!1,differences:new codebrowser.model.Diff("",""),inspector:!1,initialize:function(){this.$el.hide(),this.topContainer=$("<div>",{id:"editor-top-container"}),this.editorElement=$("<div>",{id:"editor"}),this.settingsView=new codebrowser.view.EditorSettingsView({parentView:this}),this.sideEditorElement=$("<div>",{id:"side-editor"}).hide(),this.mainEditorElement=$("<div>",{id:"main-editor"}),this.editorElement.append(this.sideEditorElement),this.editorElement.append(this.mainEditorElement),this.$el.append(this.topContainer),this.$el.append(this.editorElement),this.$el.append(this.settingsView.el),this.sideEditor=ace.edit(this.sideEditorElement.get(0)),this.mainEditor=ace.edit(this.mainEditorElement.get(0)),this.configure()},remove:function(){this.settingsView.remove(),Backbone.View.prototype.remove.call(this)},configure:function(){config.editor.configure(this.mainEditor),config.editor.configure(this.sideEditor)},removeDecorations:function(a){for(;this.decorations[a.container.id].length>0;){var b=this.decorations[a.container.id].pop();a.getSession().removeGutterDecoration(b.row,b.style)}},removeMarkers:function(a){for(;this.markers[a.container.id].length>0;)a.getSession().removeMarker(this.markers[a.container.id].pop())},removeInsertedLines:function(a){for(var b=ace.require("ace/range").Range;this.insertedLines[a.container.id].length>0;){var c=this.insertedLines[a.container.id].pop();a.getSession().remove(new b(c.rowStart,0,c.rowEnd+1,0))}},resetReplacedLines:function(a){for(var b=ace.require("ace/range").Range;this.replacedLines[a.container.id].length>0;){var c=this.replacedLines[a.container.id].pop();a.getSession().replace(new b(c.rowStart,0,c.rowEnd,a.getSession().getLine(c.rowEnd).length),c.lines)}},clearDiff:function(){this.removeDecorations(this.mainEditor),this.removeDecorations(this.sideEditor),this.removeInsertedLines(this.mainEditor),this.resetReplacedLines(this.mainEditor),this.removeMarkers(this.mainEditor),this.removeMarkers(this.sideEditor)
},render:function(){var a={previous:this.previousModel.toJSON(),difference:this.differences.getCount(),percentageOfChange:Math.round(100*(this.differences.getCount().total()/this.model.lines()))},b=$(this.template.topContainer(_.extend(this.model.toJSON(),a)));$("#editor-inspector",b).popover({animation:!1,html:!0,trigger:"click"}),this.topContainer.html(b),this.inspector&&$("#editor-inspector").popover("toggle")},fold:function(a,b){_.each(b,function(b){a.getSession().foldAll(b.start.row,b.end.row,0)})},decorateGutter:function(a,b,c,d){for(var e=b;c>=e;e++)this.decorations[a.container.id].push({row:e,style:"decoration gutter-"+d}),a.getSession().addGutterDecoration(e,"decoration gutter-"+d)},setContent:function(a,b,c){var d=_.clone(a.getSession().getAllFolds()),e=a.getSelection().getSelectionAnchor(),f=a.getSession().getScrollTop();this.removeDecorations(a),this.removeMarkers(a),a.setValue(b),this.fold(a,d),a.moveCursorToPosition(e),a.getSelection().clearSelection(),a.getSession().setScrollTop(f),a.getSession().setMode(c)},update:function(a,b){var c=this;this.model=b,this.previousModel=a;var d=_.after(2,function(){var a=c.sideEditor.getValue(),b=c.mainEditor.getValue();c.differences=new codebrowser.model.Diff(a,b),c.toggleDiff(c.diff),c.render()}),e=codebrowser.helper.AceMode.getModeForFilename(this.model.get("name"));this.previousModel===this.model?this.toggleSplit(!1):this.split||this.toggleSplit("true"===localStorage.getItem(config.storage.view.EditorView.split)),this.diff?this.clearDiff():this.toggleDiff("true"===localStorage.getItem(config.storage.view.EditorView.diff)),this.previousModel!==this.model&&a.fetchContent(function(a,b){if(b)throw new Error("Failed file fetch.");c.setContent(c.sideEditor,a,e),d()}),this.model.fetchContent(function(a,b){if(b)throw new Error("Failed file fetch.");c.previousModel===c.model&&(c.setContent(c.sideEditor,null,e),d()),c.setContent(c.mainEditor,a,e),d()}),this.$el.show(),this.render()},didResize:function(){this.inspector&&($("#editor-inspector").popover("toggle"),$("#editor-inspector").popover("toggle")),this.mainEditor.resize(),this.sideEditor.resize()},didSplit:function(){this.diff&&(this.clearDiff(),this.toggleDiff(this.diff)),this.mainEditor.resize(),this.sideEditor.resize(),this.mainEditor.renderer.updateFull(),this.sideEditor.renderer.updateFull()},toggleSplit:function(a){return void 0!==a?this.split=a:(this.split=!this.split,localStorage.setItem(config.storage.view.EditorView.split,this.split)),this.split?(this.sideEditorElement.css({"float":"left",width:"50%"}),this.sideEditorElement.show(),this.mainEditorElement.css({"float":"right",width:"50%"}),this.didSplit(),void 0):(this.sideEditorElement.hide(),this.mainEditorElement.css({"float":"",width:""}),this.didSplit(),void 0)},toggleDiff:function(a){var b=ace.require("ace/range").Range;if(void 0!==a?this.diff=a:(this.diff=!this.diff,localStorage.setItem(config.storage.view.EditorView.diff,this.diff)),this.diff)for(var c=0;c<this.differences.getDifferences().all.length;c++){var d,e=this.differences.getDifferences().all[c];if("delete"===e.type){if(this.split){d=this.sideEditor.getSession().addMarker(new b(e.fromRowStart,0,e.fromRowEnd,1),e.type,"fullLine"),this.decorateGutter(this.sideEditor,e.fromRowStart,e.fromRowEnd,"delete"),this.markers["side-editor"].push(d);continue}e.overwrite?(this.replacedLines["main-editor"].push({rowStart:e.rowStart,rowEnd:e.rowEnd,lines:this.mainEditor.getSession().getLines(e.rowStart,e.rowEnd).join("\n")}),this.mainEditor.getSession().replace(new b(e.rowStart,0,e.rowEnd,this.mainEditor.getSession().getLine(e.rowEnd).length),e.lines)):(this.mainEditor.getSession().insert({row:e.rowStart+e.offset,column:0},e.lines),this.insertedLines["main-editor"].push({rowStart:e.rowStart+e.offset,rowEnd:e.rowEnd+e.offset})),this.decorateGutter(this.mainEditor,e.rowStart+e.offset,e.rowEnd+e.offset,"delete")}var f=0;this.split||(f=e.offset),d=this.mainEditor.getSession().addMarker(new b(e.rowStart+f,0,e.rowEnd+f,1),e.type,"fullLine"),this.decorateGutter(this.mainEditor,e.rowStart+f,e.rowEnd+f,e.type),this.markers["main-editor"].push(d)}else this.clearDiff()},toggleInspector:function(a){a.preventDefault(),this.inspector=!this.inspector}}),codebrowser.view.ErrorView=Backbone.View.extend({id:"error-container",template:Handlebars.templates.Error,render:function(){var a=this.template(this.model);this.$el.html(a)}}),codebrowser.view.ExercisesView=Backbone.View.extend({id:"exercises-container",template:Handlebars.templates.ExercisesContainer,render:function(){var a={studentId:this.collection.studentId,courseId:this.collection.courseId,course:this.course.toJSON(),exercises:this.collection.toJSON()};this.student&&(a=_.extend(a,{student:this.student.toJSON()}));var b=this.template(a);this.$el.html(b)}}),codebrowser.view.NotFoundErrorView=codebrowser.view.ErrorView.extend({model:{"class":"alert-warning",message:"Not Found."}}),codebrowser.view.RootView=Backbone.View.extend({id:"root-container",template:Handlebars.templates.RootContainer,render:function(){var a=this.template();this.$el.html(a)}}),codebrowser.view.SnapshotFilesView=Backbone.View.extend({id:"snapshot-files-container",template:Handlebars.templates.SnapshotFilesContainer,initialize:function(a){this.parentView=a.parentView},renderDifferences:function(a){var b=this;this.parentView.collection.getDifferences(function(c){var d=b.parentView.collection.indexOf(b.model),e=c[d],f=b.model.get("files");f.each(function(b){var c=e[b.get("name")],d=$('[data-id="'+b.id+'"]',a),f=b.lines(),g=c.getCount().total();g===f&&d.addClass("new"),g>0&&f>g&&d.addClass("modified")})})},render:function(){var a=$(this.template(this.model.toJSON()));this.parentView.editorView.diff&&this.renderDifferences(a);var b=$('[data-id="'+this.file.id+'"]',a);b.addClass("active"),this.$el.html(a)},update:function(a,b){this.model=a,this.file=b,this.render()}}),codebrowser.view.SnapshotView=Backbone.View.extend({id:"snapshot-container",template:{navigationContainer:Handlebars.templates.SnapshotNavigationContainer},events:{"click #toggleFiles":"toggleFiles","click #split":"split","click #diff":"diff","click #first":"first","click #previous":"previous","click #next":"next","click #last":"last"},files:!0,initialize:function(){this.navigationContainer=$("<div>",{id:"snapshot-navigation-container"}),this.$el.append(this.navigationContainer);var a=$("<div>",{id:"snapshot-content-container"});this.snapshotFilesView=new codebrowser.view.SnapshotFilesView({parentView:this}),a.append(this.snapshotFilesView.el),this.editorView=new codebrowser.view.EditorView,a.append(this.editorView.el),this.$el.append(a),$(window).resize($.proxy(this.resize,this)),$(document).keydown($.proxy(this.keydown,this))},remove:function(){$(window).off("resize",this.resize),$(document).off("keydown",this.keydown),this.editorView.remove(),Backbone.View.prototype.remove.call(this)},render:function(){var a=this.collection.indexOf(this.model),b={current:a+1,total:this.collection.length},c=$(this.template.navigationContainer(b));this.files&&$("#toggleFiles",c).addClass("active"),this.editorView.split&&$("#split",c).addClass("active"),this.editorView.canSplit()||$("#split",c).attr("disabled",!0),this.editorView.diff&&$("#diff",c).addClass("active"),0===a&&($("#first",c).attr("disabled",!0),$("#previous",c).attr("disabled",!0)),a===this.collection.length-1&&($("#next",c).attr("disabled",!0),$("#last",c).attr("disabled",!0)),this.navigationContainer.html(c)},update:function(a,b){this.model=a,this.files&&this.toggleFiles(null,"true"===localStorage.getItem(config.storage.view.SnapshotView.files));var c=this.collection.indexOf(a),d=this.collection.at(c-1);d||(d=this.model),this.file=this.model.get("files").get(b);var e=this.file.get("name"),f=d.get("files").findWhere({name:e});this.editorView.update(f||this.file,this.file),this.snapshotFilesView.update(this.model,this.file),this.render()},resize:function(){this.didResize()},didResize:function(){this.editorView.didResize()},keydown:function(a){37===a.keyCode&&this.previous(),39===a.keyCode&&this.next()},toggleFiles:function(a,b){return void 0!==b?this.files=b:(this.files=!this.files,localStorage.setItem(config.storage.view.SnapshotView.files,this.files)),this.files?(this.editorView.$el.css("margin-left",this.snapshotFilesView.$el.width()+30),this.editorView.didResize(),this.snapshotFilesView.$el.show(),void 0):(this.snapshotFilesView.$el.hide(),this.editorView.$el.css("margin-left",0),this.editorView.didResize(),void 0)},split:function(){this.editorView.toggleSplit()},diff:function(){this.editorView.toggleDiff(),this.snapshotFilesView.update(this.model,this.file)},navigate:function(a,b,c){b||(b=a.get("files").first()),codebrowser.app.snapshot.navigate("#/students/"+this.collection.studentId+"/courses/"+this.collection.courseId+"/exercises/"+this.collection.exerciseId+"/snapshots/"+a.id+"/files/"+b.id,{replace:c?c.replace:c})},first:function(){var a=this.collection.first(),b=a.get("files").findWhere({name:this.file.get("name")});this.navigate(a,b)},previous:function(){var a=this.collection.indexOf(this.model),b=this.collection.at(a-1);if(b){var c=b.get("files").findWhere({name:this.file.get("name")});this.navigate(b,c)}},next:function(){var a=this.collection.indexOf(this.model),b=this.collection.at(a+1);if(b){var c=b.get("files").findWhere({name:this.file.get("name")});this.navigate(b,c)}},last:function(){var a=this.collection.last(),b=a.get("files").findWhere({name:this.file.get("name")});this.navigate(a,b)}}),codebrowser.view.SnapshotsTimelineView=Backbone.View.extend({id:"snapshots-timeline-container",template:{bottomContainer:Handlebars.templates.SnapshotsTimelineBottomContainer},width:0,snapshotElements:[],pointerSetOffsetX:0,scroll:null,dragging:!1,initialize:function(a){this.parentView=a.parentView,this.$el.hide(),this.paper=Raphael(this.el,"100%",81),this.bottomContainer=$("<div>"),this.$el.append(this.bottomContainer)},getViewX:function(){var a=0;return this.paper._viewBox&&(a=this.paper._viewBox[0]),a},isVisible:function(a){var b=this.getViewX(),c=$(this.paper.canvas).width();return a>=b&&b+c>=a},snapshotWeight:function(a){var b=this.differences[a],c=.8,d=Math.round(100*(b.total/b.lines));return 0===d?c:(c=2*d/100+1,c=Math.round(2*c)/2,Math.min(2,c))},distanceWeight:function(a,b,c){var d=0;if(0===a)return 1;var e=this.collection.getDuration(a,a-1);return d=5*(e-b)/(c-b)+1,d=Math.round(100*d)/100,Math.min(6,d)},setViewBox:function(a){var b=$(this.paper.canvas).width();this.paper.setViewBox(a,0,b,this.paper.height,!1)},centerOn:function(a){var b=$(this.paper.canvas).width(),c=a-b/2;return 0>c?(this.setViewBox(0),void 0):c>this.width-b?(this.setViewBox(this.width-b),void 0):(this.setViewBox(c),void 0)},focus:function(){var a=this.snapshotElements[this.currentSnapshotIndex].attr("cx");0!==this.currentSnapshotIndex&&(this.isVisible(this.snapshotElements[this.currentSnapshotIndex-1].attr("cx"))||this.centerOn(a)),this.currentSnapshotIndex!==this.snapshotElements.length-1&&(this.isVisible(this.snapshotElements[this.currentSnapshotIndex+1].attr("cx"))||this.centerOn(a))},moveTimeline:function(a){var b=this.getViewX(),c=$(this.paper.canvas).width();if(0>b+a&&0>a)return this.setViewBox(Math.max(0,0-b)),void 0;if(b+c+a>=this.width&&a>0){var d=this.width-b-c;return this.setViewBox(b+d),void 0}this.setViewBox(b+a),this.pointerSetOffsetX+=a,this.pointerSet.transform("...t "+a+", 0")},renderDuration:function(a,b,c,d,e,f){if(a){var g=codebrowser.helper.Duration.calculate(b.get("snapshotTime"),a.get("snapshotTime"),!0),h=this.paper.text(c-e-f/2,d+30,g);$(h.node).attr("class","duration")}},renderTimeline:function(a,b,c){var d=this.paper.path("M "+a+" "+b+" L "+c+" "+b);$(d.node).attr("class","timeline"),d.toBack()},renderSnapshotIndex:function(a,b){var c=this.paper.text(b,5,a+1);$(c.node).attr("class","snapshot-index")},renderSnapshotWeight:function(a,b,c){var d=this.differences[a],e=(d.total/d.lines).toFixed(2);if("0.00"!==e){e="1.00"!==e?e.slice(1):e.slice(0,1);var f=this.paper.text(b,c,e),g=this.snapshotWeight(a),h=11;g>1&&(h*=g),f.attr({"font-size":h}),$(f.node).attr("class","snapshot-weight")}},renderSnapshot:function(a,b,c,d,e){this.renderSnapshotIndex(b,c);var f=this.paper.rect(c-e,0,2*e,this.paper.height);$(f.node).attr("class","area");var g=this.paper.circle(c,d,e);$(g.node).attr("class","snapshot"),this.renderSnapshotWeight(b,c,d);var h=this.paper.circle(c,d,e);$(h.node).attr("class","area snapshot"),$(h.node).attr({"data-toggle":"tooltip",title:moment(new Date(a.get("snapshotTime"))).format("D.M.YYYY HH.mm"),"data-container":"body"});var i=a.get("files").findWhere({name:this.filename});f.data("snapshot",a),f.data("file",i),h.data("snapshot",a),h.data("file",i);var j=this;return h.click(function(){var a=this.data("snapshot"),b=this.data("file");j.parentView.navigate(a,b)}),h.mouseover(function(){this.animate({transform:"S 1.1"},150),g.animate({transform:"S 1.1"},150),j.scroll||$(h.node).tooltip("show")}),h.mouseout(function(){this.animate({transform:"S 1"},150),g.animate({transform:"S 1"},150),$(h.node).tooltip("hide")}),g},renderPointer:function(a,b){this.pointerSet=this.paper.set();var c=7,d=a-c/2,e=this.paper.height,f=a,g=e-c/2,h=this.paper.path("M"+f+" "+g+", L"+f+" "+0);$(h.node).attr("class","pointer-line"),h.toBack(),this.pointerSet.push(h);var i=this.paper.path("M"+d+" "+e+", L"+(d+c/2)+" "+(e-c)+", "+(d+c)+" "+e+"Z");$(i.node).attr("class","pointer"),this.pointerSet.push(i);var j=this.paper.rect(a-b,0,2*b,this.paper.height);$(j.node).attr("class","area pointer"),this.pointerSet.push(j),this.pointerSet.drag(this.dragMove,this.dragStart,this.dragEnd,this,this,this).onDragOver($.proxy(this.dragOver,this))},render:function(){var a=this.collection.getMinDuration(),b=Math.min(3e5,this.collection.getMaxDuration());this.paper.clear();var c=this.paper.height/2+3,d=0,e=0,f=0,g=this;this.collection.each(function(h,i){var j=g.distanceWeight(i,a,b),k=g.snapshotWeight(i),l=45*j,m=12*k;f+=2*m,0===i?d=f:f+=l,i===g.collection.length-1&&(e=m);var n=g.collection.at(i-1);g.renderDuration(n,h,f,c,m,l);var o=g.renderSnapshot(h,i,f,c,m);g.snapshotElements.push(o),i===g.currentSnapshotIndex&&g.renderPointer(f,m)}),this.renderTimeline(d,c,f),this.width=d+f+e,this.focus();var h={first:this.collection.first().toJSON(),last:this.collection.last().toJSON()},i=this.template.bottomContainer(h);this.bottomContainer.html(i,i)},update:function(a,b,c){if(this.collection=a,1!==this.collection.length){this.$el.show(),this.startSpinner();var d=this;this.collection.getDifferences(function(a){d.differences=a,d.currentSnapshotIndex=b,d.filename=c,d.stopSpinner(),d.dragging||d.render()})}},didResize:function(){var a=this.snapshotElements[this.currentSnapshotIndex].attr("cx");this.render(),this.centerOn(a)},dragStart:function(){this.dragging=!0},dragEnd:function(){this.dragging=!1,this.pointerSetOffsetX=0,this.stopScroll(),this.render()},dragMove:function(a,b,c){this.pointerSet.transform("T "+(this.pointerSetOffsetX+a)+", 0");var d=$(this.paper.canvas).width(),e=$(this.paper.canvas).offset(),f=e.left,g=e.left+d;return f+50>c?(this.startScroll(-5),void 0):c>g-50?(this.startScroll(5),void 0):(this.stopScroll(),void 0)},dragOver:function(a){a.data("snapshot")&&this.parentView.navigate(a.data("snapshot"),a.data("file"))},startSpinner:function(){this.spinner||(this.spinner=new Spinner({lines:13,length:4,width:4,radius:10,corners:1,rotate:0,direction:1,color:"rgba(0, 0, 0, 0.4)",speed:.8,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"}).spin(this.$el.get(0)))},stopSpinner:function(){this.spinner&&this.spinner.stop()},startScroll:function(a){if(!this.scroll){var b=this;this.scroll=setInterval(function(){b.moveTimeline(a)},1e3/60)}},stopScroll:function(){this.scroll&&(clearInterval(this.scroll),this.scroll=!1)}}),codebrowser.view.StudentsView=Backbone.View.extend({id:"students-container",template:Handlebars.templates.StudentsContainer,render:function(){var a={students:this.collection.toJSON()};this.course&&this.exercise&&(a=_.extend(a,{course:this.course.toJSON(),exercise:this.exercise.toJSON()}));var b=this.template(a);this.$el.html(b)}}),codebrowser.controller.ViewController={view:null,isActive:function(a){return this.view===a},push:function(a,b){this.view&&this.view.remove(),this.view=a,b&&this.view.render(),$(config.view.container).html(this.view.el)}},codebrowser.router.BaseRouter=Backbone.Router.extend({routes:{"":"root","*notFound":"notFound"},initialize:function(){this.rootView=new codebrowser.view.RootView,this.errorView=new codebrowser.view.ErrorView({model:{"class":"alert-error",message:"Oops!"}})},root:function(){this.rootView.render(),codebrowser.controller.ViewController.push(this.rootView)},notFound:function(){codebrowser.controller.ViewController.push(this.errorView,!0)}}),codebrowser.router.CourseRouter=Backbone.Router.extend({routes:{"courses(/)":"courses","students/:studentId(/)":"navigation","students/:studentId/courses(/)":"courses"},initialize:function(){this.courseView=new codebrowser.view.CoursesView},notFound:function(){var a=new codebrowser.view.NotFoundErrorView;codebrowser.controller.ViewController.push(a,!0)},navigation:function(a){codebrowser.app.course.navigate("#/students/"+a+"/courses",{replace:!0})},courses:function(a){var b=this,c=_.after(2,function(){b.courseView.render(),codebrowser.controller.ViewController.push(b.courseView)}),d=codebrowser.model.Student.findOrCreate({id:a});d.fetch({cache:!0,expires:config.cache.expires,success:function(){b.courseView.student=d,c()},error:function(){b.notFound()}});var e=new codebrowser.collection.CourseCollection(null,{studentId:a});this.courseView.collection=e,e.fetch({cache:!0,expires:config.cache.expires,success:function(){c()},error:function(){b.notFound()}})}}),codebrowser.router.ExerciseRouter=Backbone.Router.extend({routes:{"courses/:courseId(/)":"navigateToCourseExercises","courses/:courseId/exercises(/)":"courseExercises","students/:studentId/courses/:courseId(/)":"navigation","students/:studentId/courses/:courseId/exercises(/)":"exercises"},initialize:function(){this.exerciseView=new codebrowser.view.ExercisesView},notFound:function(){var a=new codebrowser.view.NotFoundErrorView;codebrowser.controller.ViewController.push(a,!0)},navigateToCourseExercises:function(a){codebrowser.app.exercise.navigate("#/courses/"+a+"/exercises",{replace:!0})},navigation:function(a,b){codebrowser.app.exercise.navigate("#/students/"+a+"/courses/"+b+"/exercises",{replace:!0})},courseExercises:function(a){this.exercises(null,a)},exercises:function(a,b){var c=this,d=_.after(3,function(){c.exerciseView.render(),codebrowser.controller.ViewController.push(c.exerciseView)});if(a){var e=codebrowser.model.Student.findOrCreate({id:a});e.fetch({cache:!0,expires:config.cache.expires,success:function(){c.exerciseView.student=e,d()},error:function(){c.notFound()}})}else d();var f=codebrowser.model.Course.findOrCreate({id:b}),g=new codebrowser.collection.ExerciseCollection(null,{studentId:a,courseId:b});g.course=f,f.fetch({cache:!0,expires:config.cache.expires,success:function(){c.exerciseView.course=f,d()},error:function(){c.notFound()}}),this.exerciseView.collection=g,g.fetch({cache:!0,expires:config.cache.expires,success:function(){d()},error:function(){c.notFound()}})}}),codebrowser.router.SnapshotRouter=Backbone.Router.extend({routes:{"students/:studentId/courses/:courseId/exercises/:exerciseId(/)":"snapshot","students/:studentId/courses/:courseId/exercises/:exerciseId/snapshots(/)":"snapshot","students/:studentId/courses/:courseId/exercises/:exerciseId/snapshots/:snapshotId(/)":"snapshot","students/:studentId/courses/:courseId/exercises/:exerciseId/snapshots/:snapshotId/files/:fileId(/)":"snapshot","courses/:courseId/exercises/:exerciseId/students/:studentId/snapshots(/)":"navigation"},initialize:function(){this.setUp()},setUp:function(){codebrowser.controller.ViewController.isActive(this.snapshotView)||(this.snapshotView=new codebrowser.view.SnapshotView,codebrowser.controller.ViewController.push(this.snapshotView))},notFound:function(){var a=new codebrowser.view.NotFoundErrorView;codebrowser.controller.ViewController.push(a,!0)},navigation:function(a,b,c){this.snapshot(c,a,b)},snapshot:function(a,b,c,d,e){this.setUp();var f=new codebrowser.collection.SnapshotCollection(null,{studentId:a,courseId:b,exerciseId:c});this.snapshotView.collection=f;var g=this;f.fetch({cache:!0,expires:config.cache.expires,success:function(){var a;return d?(a=f.get(d))?e?a.get("files").get(e)?(g.snapshotView.update(a,e),void 0):(g.notFound(),void 0):(g.snapshotView.navigate(a,null),void 0):(g.notFound(),void 0):(a=f.at(0),g.snapshotView.navigate(a,null,{replace:!0}),void 0)},error:function(){g.notFound()}})}}),codebrowser.router.StudentRouter=Backbone.Router.extend({routes:{"students(/)":"students","courses/:courseId/exercises/:exerciseId(/)":"navigation","courses/:courseId/exercises/:exerciseId/students(/)":"exerciseStudents"},initialize:function(){this.studentView=new codebrowser.view.StudentsView},notFound:function(){var a=new codebrowser.view.NotFoundErrorView;codebrowser.controller.ViewController.push(a,!0)},navigation:function(a,b){codebrowser.app.student.navigate("#/courses/"+a+"/exercises/"+b+"/students",{replace:!0})},exerciseStudents:function(a,b){this.students({courseId:a,exerciseId:b})},students:function(a){var b=this,c=_.after(3,function(){b.studentView.render(),codebrowser.controller.ViewController.push(b.studentView)});if(a){var d=codebrowser.model.Course.findOrCreate({id:a.courseId});d.fetch({cache:!0,expires:config.cache.expires,success:function(){b.studentView.course=d,c()},error:function(){b.notFound()}});var e=codebrowser.model.Exercise.findOrCreate({id:a.exerciseId});e.fetch({cache:!0,expires:config.cache.expires,success:function(){b.studentView.exercise=e,c()},error:function(){b.notFound()}})}else c(),c();var f=new codebrowser.collection.StudentCollection(a);this.studentView.collection=f,f.fetch({cache:!0,expires:config.cache.expires,success:function(){c()},error:function(){b.notFound()}})}});